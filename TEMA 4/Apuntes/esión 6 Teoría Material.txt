esi√≥n 6: Teor√≠a
üìò Material Did√°ctico: Sesi√≥n 6
Fundamentos de Next.js (App Router)
üéØ Objetivos de la sesi√≥n

    Comprender la diferencia entre una Librer√≠a (React) y un Framework (Next.js).
    Dominar el sistema de enrutamiento basado en archivos (App Router).
    Aprender a compartir interfaz entre p√°ginas usando Layouts.
    Gestionar la navegaci√≥n sin recargas usando el componente Link.
    Crear rutas din√°micas (para fichas de producto, perfiles, etc.) y manejar errores 404.

1. React vs. Next.js: ¬øPor qu√© dar el salto?

Hasta ahora hemos usado React (con Vite) para crear componentes. React es una librer√≠a: hace una cosa muy bien (crear interfaces de usuario), pero te deja a ti la responsabilidad de decidir qu√© herramientas usar para el enrutamiento, la carga de im√°genes, el SEO, etc.
Next.js es un Framework para React.
Imagina que React es el motor de un coche. Next.js es el coche entero: ya viene con las ruedas, el chasis, el volante y el sistema de navegaci√≥n instalados.

Principales ventajas de Next.js (App Router):

    Routing autom√°tico: No necesitas instalar react-router-dom. Las carpetas definen las rutas.
    Renderizado H√≠brido: Puede renderizar en el servidor (Server Components) o en el cliente.
    Optimizaci√≥n: Carga de im√°genes, fuentes y scripts optimizados autom√°ticamente.

2. El Sistema de Enrutamiento (App Router)

En Next.js, la estructura de carpetas define la estructura de las URLs. Todo nuestro trabajo ocurrir√° dentro de la carpeta app/.
Reglas de Oro:

    Carpetas = Rutas: El nombre de la carpeta es el segmento de la URL.
    page.tsx = UI: Para que una ruta sea p√∫blica, la carpeta debe contener un archivo page.tsx. Si creas una carpeta sin este archivo, no ser√° accesible (√∫til para guardar componentes internos).

Visualizaci√≥n de Estructura:
üìÇ app
  üìÑ page.tsx (Inicio)
  üìÇ contacto
    üìÑ page.tsx (/contacto)
  üìÇ blog
    üìÇ primer-post
      üìÑ page.tsx (/blog/primer-post)

Ejemplo:

    app/page.tsx ‚Üí Ruta: / (Inicio)
    app/contacto/page.tsx ‚Üí Ruta: /contacto
    app/blog/primer-post/page.tsx ‚Üí Ruta: /blog/primer-post

C√≥digo de una p√°gina b√°sica (app/contacto/page.tsx):

export default function ContactPage() {
  return (
    <main className="p-10">
      <h1 className="text-3xl font-bold text-blue-600">Cont√°ctanos</h1>
      <p>Env√≠anos un correo a info@mitienda.com</p>
    </main>
  );
}

3. Layouts: Compartiendo UI (layout.tsx)

A menudo queremos elementos que aparezcan en todas las p√°ginas, como un Navbar o un Footer. En React tradicional, ten√≠amos que importar el Navbar en cada p√°gina. En Next.js, usamos layout.tsx.

El layout.tsx envuelve a las p√°ginas (o a otros layouts anidados).

    Root Layout (app/layout.tsx): Es obligatorio. Define las etiquetas <html> y <body>. Todo lo que pongas aqu√≠ aparecer√° en toda la aplicaci√≥n.

Ejemplo de Root Layout con Navbar:

import Navbar from "@/components/Navbar"; // Asumiendo que ya creaste el componente
import "./globals.css";

// Tipado para las props del layout
interface RootLayoutProps {
  children: React.ReactNode;
}

export default function RootLayout({ children }: RootLayoutProps) {
  return (
    <html lang="es">
      <body className="bg-gray-50 text-gray-900">
        {/* El Navbar se renderiza una vez y persiste al navegar */}
        <Navbar />
        
        {/* 'children' es la p√°gina actual que estamos visitando */}
        <div className="container mx-auto p-4">
            {children}
        </div>
        
        <footer className="bg-gray-800 text-white p-4 text-center">
            ¬© 2024 Mi Tienda Online
        </footer>
      </body>
    </html>
  );
}

4. Navegaci√≥n SPA: El componente <Link>

En HTML est√°ndar usamos <a href="/contacto">. Esto provoca una recarga completa de la p√°gina (la pantalla parpadea en blanco, se pierden estados).

En Next.js usamos el componente <Link>. Esto permite una navegaci√≥n tipo SPA (Single Page Application): solo se cambia el contenido principal, sin recargar el navegador.

import Link from "next/link";

export default function Navbar() {
  return (
    <nav className="flex gap-4 p-4 bg-white shadow">
      {/* INCORRECTO en Next.js (recarga la p√°gina) */}
      <a href="/">Inicio (Lento)</a>

      {/* CORRECTO (navegaci√≥n instant√°nea) */}
      <Link href="/" className="text-blue-500 hover:underline">
        Inicio
      </Link>
      
      <Link href="/catalogo" className="text-blue-500 hover:underline">
        Cat√°logo
      </Link>
    </nav>
  );
}

5. Rutas Din√°micas ([slug])

¬øQu√© pasa si tenemos 1000 productos? No podemos crear 1000 carpetas (app/producto/1, app/producto/2...). Usamos segmentos din√°micos envolviendo el nombre de la carpeta entre corchetes.
Estructura: app/productos/[id]/page.tsx

Esta p√°gina capturar√° cualquier ruta como /productos/zapato, /productos/123, etc. El valor din√°mico se recibe a trav√©s de las props bajo la clave params.

C√≥digo (app/productos/[id]/page.tsx):

interface ProductPageProps {
  params: {
    id: string; // El nombre coincide con el de la carpeta [id]
  }
}

export default function ProductDetail({ params }: ProductPageProps) {
  return (
    <div className="p-10">
      <h1 className="text-2xl font-bold">Detalle del Producto</h1>
      <p className="mt-4">
        Est√°s viendo el producto con ID: 
        <span className="font-mono bg-yellow-200 px-2 rounded ml-2">
            {params.id}
        </span>
      </p>
      {/* Aqu√≠ m√°s adelante haremos el fetch a la API usando este ID */}
    </div>
  );
}

6. Manejo de Errores 404 (not-found.tsx)

Si un usuario navega a una URL que no existe, Next.js muestra un 404 gen√©rico. Podemos personalizarlo creando un archivo not-found.tsx en la ra√≠z de app/.

Tambi√©n podemos activar este error program√°ticamente (por ejemplo, si buscamos un producto en la base de datos y no existe) usando la funci√≥n notFound().

Ejemplo (app/not-found.tsx):

import Link from "next/link";

export default function NotFound() {
  return (
    <div className="flex flex-col items-center justify-center h-screen">
      <h2 className="text-4xl font-bold text-red-500">404</h2>
      <p className="text-xl mb-4">P√°gina no encontrada</p>
      <Link 
        href="/" 
        className="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition"
      >
        Volver al Inicio
      </Link>
    </div>
  );
}

üìù Resumen de Archivos Especiales en App Router
Archivo 	Funci√≥n
page.tsx 	La interfaz √∫nica de una ruta. Hace la ruta accesible p√∫blicamente.
layout.tsx 	Interfaz compartida (wrappers) para una ruta y sus hijas.
not-found.tsx 	UI para errores 404 dentro de esa ruta.
loading.tsx 	(Lo veremos en la Sesi√≥n 7) UI de carga autom√°tica.
error.tsx 	(Avanzado) Manejo de errores en tiempo de ejecuci√≥n.
